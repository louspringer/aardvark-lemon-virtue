{
  "databaseChangeLog": [
    {
      "changeSet": [
        {
          "id": "create-raw-jobs-table",
          "author": "louspringer",
          "preConditions": {
            "onFail": "MARK_RAN",
            "not": {
              "tableExists": {
                "schemaName": "QUERY_LINKEDIN",
                "tableName": "raw_jobs"
              }
            }
          },
          "changes": [
            {
              "createTable": {
                "tableName": "raw_jobs",
                "schemaName": "QUERY_LINKEDIN",
                "columns": [
                  {
                    "column": {
                      "name": "job_id",
                      "type": "UUID",
                      "constraints": {
                        "primaryKey": true
                      }
                    }
                  },
                  {
                    "column": {
                      "name": "request_pk",
                      "type": "UUID",
                      "constraints": {
                        "nullable": false
                      }
                    }
                  },
                  {
                    "column": {
                      "name": "json_response",
                      "type": "TEXT"
                    }
                  },
                  {
                    "column": {
                      "name": "created_at",
                      "type": "TIMESTAMP",
                      "constraints": {
                        "defaultValueComputed": "CURRENT_TIMESTAMP",
                        "nullable": false
                      }
                    }
                  }
                ],
                "constraints": [
                  {
                    "addForeignKeyConstraint": {
                      "baseTableName": "request",
                      "baseColumnNames": "request_pk",
                      "referencedTableName": "raw_jobs",
                      "referencedColumnNames": "job_id",
                      "constraintName": "fk_request_raw_jobs"
                    }
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "changeSet": [
        {
          "id": "create-request-table",
          "author": "your_name",
          "preConditions": {
            "onFail": "MARK_RAN",
            "not": {
              "tableExists": {
                "schemaName": "QUERY_LINKEDIN",
                "tableName": "request"
              }
            }
          },
          "changes": [
            {
              "createTable": {
                "tableName": "request",
                "schemaName": "QUERY_LINKEDIN",
                "columns": [
                  {
                    "column": {
                      "name": "request_pk",
                      "type": "UUID",
                      "constraints": {
                        "primaryKey": true
                      }
                    }
                  },
                  {
                    "column": {
                      "name": "query_parameters",
                      "type": "TEXT"
                    }
                  },
                  {
                    "column": {
                      "name": "status_code",
                      "type": "INT"
                    }
                  },
                  {
                    "column": {
                      "name": "error_message",
                      "type": "TEXT"
                    }
                  },
                  {
                    "column": {
                      "name": "created_at",
                      "type": "TIMESTAMP",
                      "constraints": {
                        "defaultValueComputed": "CURRENT_TIMESTAMP",
                        "nullable": false
                      }
                    }
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "include": {
        "file": "update-table-pk-uuid.json",
        "relativeToChangelogFile": true
      }
    },
    {
      "include": {
        "file": "rename-job-id-column.json",
        "relativeToChangelogFile": true
      }
    },
    {
      "include": {
        "file": "add-comments-to-QUERY_LINKEDIN-schema.json",
        "relativeToChangelogFile": true
      }
    }
  ]
}